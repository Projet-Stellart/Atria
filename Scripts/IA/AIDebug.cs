using Godot;
using System;
using System.Diagnostics;

public partial class AIDebug : Node
{
    // Called when the node enters the scene tree for the first time.
    public override void _Ready()
    {
        TileMeshGeneration grid = GetParent<TileMeshGeneration>();
        var rand = new Random();
        grid.GetData();
        int[,,] thegoodgrid = grid.GenerateGridDebug(10, 10, 3, 1, rand);

        thegoodgrid = new int[3, 10, 10]
        {
            {
                {
                    1,
                    38,
                    39,
                    39,
                    37,
                    37,
                    37,
                    38,
                    39,
                    40,
                },
                {
                    5,
                    1,
                    1,
                    3,
                    3,
                    9,
                    9,
                    1,
                    6,
                    40,
                },
                {
                    2,
                    5,
                    3,
                    9,
                    6,
                    28,
                    2,
                    37,
                    2,
                    40,
                },
                {
                    4,
                    30,
                    39,
                    32,
                    8,
                    6,
                    32,
                    39,
                    2,
                    38,
                },
                {
                    12,
                    10,
                    37,
                    2,
                    39,
                    2,
                    2,
                    39,
                    8,
                    6,
                },
                {
                    2,
                    2,
                    37,
                    8,
                    6,
                    2,
                    8,
                    3,
                    6,
                    2,
                },
                {
                    4,
                    8,
                    1,
                    1,
                    10,
                    4,
                    5,
                    1,
                    7,
                    2,
                },
                {
                    4,
                    5,
                    9,
                    1,
                    7,
                    2,
                    4,
                    40,
                    39,
                    4,
                },
                {
                    8,
                    10,
                    8,
                    3,
                    1,
                    11,
                    7,
                    26,
                    39,
                    4,
                },
                {
                    38,
                    8,
                    1,
                    1,
                    3,
                    3,
                    3,
                    11,
                    1,
                    7,
                },
            },
            {
                {
                    37,
                    37,
                    38,
                    40,
                    37,
                    40,
                    40,
                    39,
                    38,
                    40,
                },
                {
                    38,
                    37,
                    40,
                    40,
                    40,
                    38,
                    40,
                    40,
                    39,
                    39,
                },
                {
                    39,
                    38,
                    38,
                    38,
                    37,
                    22,
                    39,
                    39,
                    37,
                    40,
                },
                {
                    5,
                    36,
                    31,
                    34,
                    3,
                    11,
                    34,
                    29,
                    27,
                    37,
                },
                {
                    4,
                    39,
                    40,
                    37,
                    38,
                    40,
                    40,
                    37,
                    38,
                    39,
                },
                {
                    4,
                    38,
                    40,
                    40,
                    40,
                    40,
                    40,
                    37,
                    40,
                    39,
                },
                {
                    28,
                    37,
                    38,
                    40,
                    39,
                    38,
                    37,
                    39,
                    40,
                    37,
                },
                {
                    40,
                    37,
                    39,
                    38,
                    39,
                    39,
                    39,
                    5,
                    27,
                    39,
                },
                {
                    39,
                    40,
                    37,
                    39,
                    37,
                    39,
                    39,
                    24,
                    39,
                    40,
                },
                {
                    39,
                    37,
                    38,
                    40,
                    39,
                    39,
                    38,
                    37,
                    37,
                    39,
                },
            },
            {
                {
                    39,
                    39,
                    37,
                    37,
                    38,
                    39,
                    38,
                    38,
                    40,
                    40,
                },
                {
                    37,
                    38,
                    40,
                    40,
                    39,
                    39,
                    37,
                    38,
                    5,
                    6,
                },
                {
                    5,
                    1,
                    6,
                    40,
                    37,
                    37,
                    38,
                    5,
                    7,
                    20,
                },
                {
                    2,
                    40,
                    33,
                    39,
                    37,
                    37,
                    37,
                    35,
                    21,
                    6,
                },
                {
                    4,
                    38,
                    12,
                    6,
                    40,
                    39,
                    40,
                    8,
                    6,
                    4,
                },
                {
                    8,
                    3,
                    7,
                    12,
                    9,
                    6,
                    39,
                    40,
                    12,
                    7,
                },
                {
                    22,
                    37,
                    38,
                    4,
                    4,
                    12,
                    3,
                    3,
                    7,
                    38,
                },
                {
                    4,
                    39,
                    5,
                    13,
                    7,
                    4,
                    40,
                    37,
                    21,
                    6,
                },
                {
                    2,
                    37,
                    2,
                    8,
                    1,
                    11,
                    3,
                    1,
                    1,
                    7,
                },
                {
                    8,
                    3,
                    7,
                    37,
                    40,
                    38,
                    37,
                    38,
                    38,
                    37,
                },
            },
        };

        var start = (Vector3I)grid.GetRandSpawnPoint(thegoodgrid, rand);
        var end = (Vector3I)grid.GetRandSpawnPoint(thegoodgrid, rand);

        Debug.Print($"Path from: {start.ToString()} to: {end.ToString()}");

        Debug.Print("Start of Path");

        foreach (Vector3I elt in Pathfinding.GetPath(start, end, thegoodgrid, grid.tileTemplates))
        {
            Debug.Print($"(x:{elt.X};{elt.Y};{elt.Z})");
        }

        Debug.Print("End Of Path");
    }

    // Called every frame. 'delta' is the elapsed time since the previous frame.
    public override void _Process(double delta)
    {
    }
}
